# Playbook: AWS S3 Compromise

**ID**: PB-21 | **‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: ‡∏™‡∏π‡∏á/‡∏ß‡∏¥‡∏Å‡∏§‡∏ï | **MITRE**: [T1530](https://attack.mitre.org/techniques/T1530/)
**‡∏ó‡∏£‡∏¥‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå**: GuardDuty S3 finding, Macie alert, CloudTrail `PutBucketPolicy`

## 1. ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
### 1.1 ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå
| ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á |
|:---|:---|
| Public bucket + PII | üî¥ ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï |
| Bucket policy ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô public | üî¥ ‡∏™‡∏π‡∏á |
| Data download ‡∏à‡∏≤‡∏Å external IP | üî¥ ‡∏™‡∏π‡∏á |
| S3 ransomware (delete + ransom note) | üî¥ ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï |
| Credentials leaked ‡πÉ‡∏ô bucket | üî¥ ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï |

### 1.2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
| ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡πÄ‡∏™‡∏£‡πá‡∏à |
|:---|:---:|
| Bucket name + region + owner tag | ‚òê |
| ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏ôbucket? ‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‚òê |
| ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô public? (Policy/ACL) | ‚òê |
| ‡πÉ‡∏Ñ‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô? (CloudTrail) | ‚òê |
| ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å download? (S3 access logs) | ‚òê |

## 2. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°
| # | ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ | ‡πÄ‡∏™‡∏£‡πá‡∏à |
|:---:|:---|:---:|
| 1 | `aws s3api put-public-access-block` ‚Äî **‡∏ö‡∏•‡πá‡∏≠‡∏Å public** | ‚òê |
| 2 | ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô credentials ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô S3 | ‚òê |
| 3 | ‡πÄ‡∏õ‡∏¥‡∏î versioning | ‚òê |
| 4 | Tag `Status: Compromised` | ‚òê |

## 3. ‡∏Å‡∏≤‡∏£‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π
| # | ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ | ‡πÄ‡∏™‡∏£‡πá‡∏à |
|:---:|:---|:---:|
| 1 | Block Public Access ‡∏£‡∏∞‡∏î‡∏±‡∏ö account (SCP) | ‚òê |
| 2 | ‡πÄ‡∏õ‡∏¥‡∏î Macie ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö data classification | ‚òê |
| 3 | ‡πÉ‡∏ä‡πâ Terraform/CloudFormation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö bucket policies | ‚òê |

## 4. ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö
| ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç | ‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á |
|:---|:---|
| PII ‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á | Legal + DPO (PDPA 72 ‡∏ä‡∏°.) |
| Credentials ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢ | CISO + [PB-16 Cloud IAM](Cloud_IAM.th.md) |
| S3 ransomware | [PB-02 Ransomware](Ransomware.th.md) |

## ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
- [‡∏Å‡∏£‡∏≠‡∏ö IR](../Framework.th.md) | [PB-27 Cloud Storage](Cloud_Storage_Exposure.th.md)
