# Playbook: API Abuse

**ID**: PB-30 | **‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: ‡∏™‡∏π‡∏á | **MITRE**: [T1106](https://attack.mitre.org/techniques/T1106/)
**‡∏ó‡∏£‡∏¥‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå**: API gateway alert, WAF alert, rate limit exceeded, SIEM anomaly

## 1. ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
### 1.1 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó API Abuse (OWASP API Top 10)
| ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á |
|:---|:---|:---|
| **BOLA** (Broken Object Level Auth) | ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á user ‡∏≠‡∏∑‡πà‡∏ô | üî¥ ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï |
| **Broken Authentication** | API key ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ç‡πÇ‡∏°‡∏¢ | üî¥ ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï |
| **Excessive Data Exposure** | API ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô | üü† ‡∏™‡∏π‡∏á |
| **Rate Abuse** | Request volume ‡∏™‡∏π‡∏á‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ | üü† ‡∏™‡∏π‡∏á |
| **BFLA** (Function Level Auth) | ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å admin endpoints | üî¥ ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï |

### 1.2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
| ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡πÄ‡∏™‡∏£‡πá‡∏à |
|:---|:---:|
| API endpoint ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÇ‡∏à‡∏°‡∏ï‡∏µ? | ‚òê |
| API key / OAuth token ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ? | ‚òê |
| Request volume/pattern? | ‚òê |
| ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á? | ‚òê |
| Source IP? | ‚òê |

## 2. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°
| # | ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ | ‡πÄ‡∏™‡∏£‡πá‡∏à |
|:---:|:---|:---:|
| 1 | **‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô API key** ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏∏‡∏Å‡∏£‡∏∏‡∏Å | ‚òê |
| 2 | **Block** source IP | ‚òê |
| 3 | **Rate limit** ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° | ‚òê |
| 4 | **‡∏ö‡∏•‡πá‡∏≠‡∏Å endpoint** ‡∏´‡∏≤‡∏Å‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• | ‚òê |

## 3. ‡∏Å‡∏≤‡∏£‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π
| # | ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ | ‡πÄ‡∏™‡∏£‡πá‡∏à |
|:---:|:---|:---:|
| 1 | ‡πÅ‡∏Å‡πâ authorization logic (BOLA/BFLA) | ‚òê |
| 2 | ‡πÉ‡∏ä‡πâ API gateway + rate limiting | ‚òê |
| 3 | ‡πÄ‡∏õ‡∏¥‡∏î behavioral analytics ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö API | ‚òê |

## 4. ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö
| ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç | ‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á |
|:---|:---|
| PII ‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á | Legal + DPO (PDPA 72 ‡∏ä‡∏°.) |
| Admin API ‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å | CISO |
| DDoS ‡∏ú‡πà‡∏≤‡∏ô API | [PB-12 DDoS](DDoS_Attack.th.md) |

## ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
- [‡∏Å‡∏£‡∏≠‡∏ö IR](../Framework.th.md) | [PB-10 Web Attack](Web_Attack.th.md)

## ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á
- [OWASP API Security Top 10](https://owasp.org/API-Security/)
